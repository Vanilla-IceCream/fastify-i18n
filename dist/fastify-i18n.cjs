"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("fastify-plugin"),g=require("node-polyglot"),f=d(async(l,e)=>{l.decorate("fallbackLocale",e.fallbackLocale),l.addHook("preParsing",async(c,u)=>{var o;const a=new g,s=(o=c.headers["accept-language"])==null?void 0:o.split(",")[0],t=Object.entries(e.messages);for(let n=0;n<t.length;n++){const[i,r]=t[n];i===s&&(a.locale(i),a.extend(r))}Object.keys(e.messages).includes(s)||(a.locale(e.fallbackLocale),a.extend(e.messages[e.fallbackLocale])),c.i18n=a})},{fastify:"4.x",name:"fastify-i18n"}),b=(l,e)=>{l.addHook("preParsing",async(c,u)=>{var o;const a=new g,s=(o=c.headers["accept-language"])==null?void 0:o.split(",")[0],t=Object.entries(e);for(let n=0;n<t.length;n++){const[i,r]=t[n];i===s&&(a.locale(i),a.extend(r))}Object.keys(e).includes(s)||(a.locale(l.fallbackLocale),a.extend(e[l.fallbackLocale])),c._i18n_local&&a.extend(c._i18n_local.phrases),c._i18n_local=a})},k=(l,e={useScope:"local"})=>e.useScope==="global"?l.i18n:l._i18n_local;exports.default=f;exports.defineI18n=b;exports.useI18n=k;
